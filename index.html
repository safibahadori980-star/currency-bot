<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>NERKHYAB</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/jalaali-js/dist/jalaali.min.js"></script>
    <style>
        :root { --bg: #000; --card: #1c1c1e; --text: #fff; --sub: #8e8e93; --accent: #32d74b; --modal: rgba(28, 28, 30, 0.95); }
        .light-mode { --bg: #f2f2f7; --card: #ffffff; --text: #000; --sub: #8e8e93; --accent: #28cd41; --modal: rgba(255, 255, 255, 0.95); }
        
        body { background: var(--bg); color: var(--text); font-family: sans-serif; margin: 0; transition: 0.3s; overflow-x: hidden; }

        /* ØµÙØ­Ù‡ Ù„ÙˆØ¯ÛŒÙ†Ú¯ Ø§ÙˆÙ„ÛŒÙ‡ */
        #splash { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s; }
        .spinner { width: 30px; height: 30px; border: 3px solid rgba(255,255,255,0.1); border-top-color: var(--accent); border-radius: 50%; animation: spin 1s linear infinite; margin-top: 20px; }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Ù‡Ø¯Ø± Ù†Ú†Ø§ */
        .top-bar { padding: 40px 25px 10px 25px; display: flex; justify-content: space-between; align-items: baseline; }
        .logo-text { font-size: 2.5rem; font-weight: 900; letter-spacing: -1.5px; }
        .date-time { text-align: left; font-size: 0.7rem; opacity: 0.7; font-weight: 300; }

        /* Ø¨Ø¯Ù†Ù‡ Ø§ØµÙ„ÛŒ */
        .container { padding: 15px; display: grid; gap: 12px; margin-bottom: 100px; }
        .grid-view { grid-template-columns: 1fr 1fr; }
        .list-view { grid-template-columns: 1fr; }
        
        .card { background: var(--card); border-radius: 28px; padding: 20px; height: 130px; display: flex; flex-direction: column; justify-content: space-between; }
        .card-header { display: flex; justify-content: space-between; }
        .flag { font-size: 2.2rem; }
        .price-val { font-size: 1.6rem; font-weight: 800; }
        .change { color: var(--accent); font-size: 0.8rem; display: flex; align-items: center; gap: 3px; }

        /* Ù…Ù†ÙˆÛŒ Ù¾Ø§ÛŒÛŒÙ† */
        .bottom-nav { position: fixed; bottom: 25px; left: 50%; transform: translateX(-50%); width: 85%; background: rgba(44,44,46,0.8); backdrop-filter: blur(20px); border-radius: 30px; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; z-index: 100; border: 1px solid rgba(255,255,255,0.05); }

        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ */
        .settings-modal { position: fixed; inset: 0; background: var(--modal); backdrop-filter: blur(20px); display: none; flex-direction: column; padding: 40px 30px; z-index: 1000; border-radius: 40px 40px 0 0; margin-top: 120px; }
        .settings-modal.active { display: flex; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        
        .toggle-group { display: flex; background: rgba(120,120,128,0.2); border-radius: 15px; padding: 3px; margin-top: 10px; }
        .toggle-btn { flex: 1; border: none; background: none; color: var(--text); padding: 12px; border-radius: 12px; cursor: pointer; font-size: 0.85rem; font-weight: 600; }
        .toggle-btn.active { background: #636366; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    </style>
</head>
<body>

    <div id="splash">
        <h1 style="color:#fff; font-size:3.5rem; font-weight:900; letter-spacing:-2px; margin:0;">NERKHYAB</h1>
        <p style="color:#32d74b; font-size:0.85rem; margin-top:10px;">Ù„Ø·ÙØ§Ù‹ Ù…Ù†ØªØ¸Ø± Ø¨Ù…Ø§Ù†ÛŒØ¯ØŒ Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ø®Ø±ÛŒÙ† Ù†Ø±Ø®â€ŒÙ‡Ø§...</p>
        <div class="spinner"></div>
    </div>

    <div class="top-bar">
        <h1 class="logo-text">NERKHYAB</h1>
        <div class="date-time" id="dt">--/--/--<br>--:-- --</div>
    </div>

    <div id="main-container" class="container grid-view"></div>

    <div class="bottom-nav">
        <i class="fas fa-plus" style="opacity:0.5"></i>
        <span style="font-size:0.8rem; opacity:0.5;">Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯</span>
        <i class="fas fa-ellipsis-h" onclick="openS()"></i>
    </div>

    <div class="settings-modal" id="sMod">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:40px;">
            <b style="font-size:1.6rem;">Settings</b>
            <i class="fas fa-times" style="opacity:0.3; font-size:1.5rem;" onclick="openS()"></i>
        </div>
        <div style="margin-bottom:30px;">
            <label style="color:var(--sub); font-size:0.8rem;">VIEW MODE</label>
            <div class="toggle-group">
                <button class="toggle-btn" id="bL" onclick="setL('list')">List</button>
                <button class="toggle-btn active" id="bG" onclick="setL('grid')">Grid</button>
            </div>
        </div>
        <div>
            <label style="color:var(--sub); font-size:0.8rem;">APPEARANCE</label>
            <div class="toggle-group">
                <button class="toggle-btn" id="bLi" onclick="setT('light')">Light</button>
                <button class="toggle-btn active" id="bDa" onclick="setT('dark')">Dark</button>
            </div>
        </div>
    </div>

    <script>
        function upDT() {
            const n = new Date(); const j = jalaali.toJalaali(n);
            const tS = n.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit', hour12: true });
            const dS = `${String(j.jm).padStart(2,'0')}/${String(j.jd).padStart(2,'0')}/${String(j.jy).substring(2)}`;
            document.getElementById('dt').innerHTML = `${dS}<br>${tS}`;
        }
        setInterval(upDT, 1000); upDT();

        function openS() { document.getElementById('sMod').classList.toggle('active'); }
        function setT(m) {
            document.body.classList.toggle('light-mode', m==='light');
            document.getElementById('bLi').classList.toggle('active', m==='light');
            document.getElementById('bDa').classList.toggle('active', m==='dark');
        }
        function setL(t) {
            document.getElementById('main-container').className = t==='grid' ? 'container grid-view' : 'container list-view';
            document.getElementById('bG').classList.toggle('active', t==='grid');
            document.getElementById('bL').classList.toggle('active', t==='list');
        }

        async function load() {
            try {
                const res = await fetch('last_rates.json?v=' + Date.now());
                const data = await res.json();
                const cont = document.getElementById('main-container');
                cont.innerHTML = '';
                const fl = {"Ø¯Ø§Ù„Ø± Ù‡Ø±Ø§Øª":"ğŸ‡ºğŸ‡¸","ØªÙˆÙ…Ø§Ù† Ø¨Ø§Ù†Ú©ÛŒ":"ğŸ‡®ğŸ‡·","ÛŒÙˆØ±Ùˆ Ù‡Ø±Ø§Øª":"ğŸ‡ªğŸ‡º","Ú©Ù„Ø¯Ø§Ø± (Ù¾Ø§Ú©Ø³ØªØ§Ù†)":"ğŸ‡µğŸ‡°","ØªÙˆÙ…Ø§Ù† Ú†Ú©":"ğŸ’³"};
                for (const [n, p] of Object.entries(data.rates)) {
                    cont.innerHTML += `<div class="card"><div class="card-header"><span class="flag">${fl[n]||'ğŸ’°'}</span><div style="text-align:left"><b>${n.split(' ')[0]}</b><br><span style="font-size:0.7rem; color:var(--sub)">${n}</span></div></div><div><div class="change"><i class="fas fa-caret-up"></i> 0.8%</div><div class="price-val">${p}</div></div></div>`;
                }
                // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù„ÙˆØ¯ÛŒÙ†Ú¯ Ø¨Ø¹Ø¯ Ø§Ø² Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                setTimeout(() => {
                    const s = document.getElementById('splash');
                    s.style.opacity = '0';
                    setTimeout(() => s.style.display = 'none', 800);
                }, 1500);
            } catch (e) { console.log(e); }
        }
        load();
    </script>
</body>
    </html>
